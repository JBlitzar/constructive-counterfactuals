import matplotlib.pyplot as plt
import os

# Proportions
proportions = [
    0.01,
    0.02,
    0.03,
    0.04,
    0.05,
    0.06,
    0.07,
    0.08,
    0.09,
    0.1,
    0.11,
    0.12,
    0.13,
    0.14,
    0.15,
    0.16,
    0.17,
    0.18,
    0.19,
    0.2,
    0.21,
    0.22,
    0.23,
    0.24,
    0.25,
    0.26,
    0.27,
    0.28,
    0.29,
    0.3,
    0.31,
    0.32,
    0.33,
    0.34,
    0.35000000000000003,
    0.36,
    0.37,
    0.38,
    0.39,
    0.4,
    0.41000000000000003,
    0.42,
    0.43,
    0.44,
    0.45,
    0.46,
    0.47000000000000003,
    0.48,
    0.49,
    0.5,
    0.51,
    0.52,
    0.53,
    0.54,
    0.55,
    0.56,
    0.5700000000000001,
    0.58,
    0.59,
    0.6,
    0.61,
    0.62,
    0.63,
    0.64,
    0.65,
    0.66,
    0.67,
    0.68,
    0.6900000000000001,
    0.7000000000000001,
    0.71,
    0.72,
    0.73,
    0.74,
    0.75,
    0.76,
    0.77,
    0.78,
    0.79,
    0.8,
    0.81,
    0.8200000000000001,
    0.8300000000000001,
    0.84,
    0.85,
    0.86,
    0.87,
    0.88,
    0.89,
    0.9,
    0.91,
    0.92,
    0.93,
    0.9400000000000001,
    0.9500000000000001,
    0.96,
    0.97,
    0.98,
    0.99,
]

# Number of samples
samples = [
    20,
    40,
    61,
    81,
    102,
    122,
    143,
    163,
    184,
    204,
    225,
    245,
    266,
    286,
    307,
    327,
    348,
    368,
    389,
    409,
    430,
    450,
    471,
    491,
    512,
    532,
    552,
    573,
    593,
    614,
    634,
    655,
    675,
    696,
    716,
    737,
    757,
    778,
    798,
    819,
    839,
    860,
    880,
    901,
    921,
    942,
    962,
    983,
    1003,
    1024,
    1044,
    1064,
    1085,
    1105,
    1126,
    1146,
    1167,
    1187,
    1208,
    1228,
    1249,
    1269,
    1290,
    1310,
    1331,
    1351,
    1372,
    1392,
    1413,
    1433,
    1454,
    1474,
    1495,
    1515,
    1536,
    1556,
    1576,
    1597,
    1617,
    1638,
    1658,
    1679,
    1699,
    1720,
    1740,
    1761,
    1781,
    1802,
    1822,
    1843,
    1863,
    1884,
    1904,
    1925,
    1945,
    1966,
    1986,
    2007,
    2027,
]

# Loss After
random_loss_after = [
    0.015223405577842186,
    0.015293522157776351,
    0.015402884975742381,
    0.015179678554147813,
    0.01522185070228943,
    0.015269283687075585,
    0.015157063558604023,
    0.015126205423712236,
    0.0149189236416305,
    0.015137844379353282,
    0.015292416118825258,
    0.015212174219641383,
    0.015195759903974704,
    0.01487011969499008,
    0.014912603118830248,
    0.01508283793918963,
    0.015053772693420342,
    0.015308911259012348,
    0.014916737385362921,
    0.014932797347739779,
    0.015424947658971178,
    0.01501237618236928,
    0.015125649794526907,
    0.014782643913008542,
    0.014757260803605732,
    0.014968012112888118,
    0.01471569351360813,
    0.014992996944158676,
    0.01486321538732227,
    0.015255345256150576,
    0.015085180316987135,
    0.014853142095603289,
    0.015067095369261096,
    0.014890159042124651,
    0.014545980555624283,
    0.014860677206456785,
    0.015185832729002868,
    0.015089723536675592,
    0.01467524205349946,
    0.014742251820450747,
    0.015007319847370582,
    0.014944943199026284,
    0.014714240037960735,
    0.014666339962445818,
    0.0152905577817819,
    0.014914056061684278,
    0.014996914899057856,
    0.014831861440939065,
    0.014610251718806921,
    0.014940024216400616,
    0.014999820355569682,
    0.015324535796764849,
    0.015126240934307589,
    0.015188342464284688,
    0.014824993127945163,
    0.014938107897194186,
    0.014610995587759135,
    0.014974135805175592,
    0.015122284573351408,
    0.014922698668613066,
    0.015251086504122213,
    0.015351462736191479,
    0.015126065241304332,
    0.015156893878099709,
    0.015332038724352515,
    0.015290908122949531,
    0.01503756845420412,
    0.015117987873338734,
    0.015216082462643499,
    0.015388096826029596,
    0.014765402555838136,
    0.015264201603088168,
    0.015080565780749566,
    0.015270050385424838,
    0.01508936449289422,
    0.015405390900639304,
    0.015272411130695218,
    0.015251728841747081,
    0.014918519408183784,
    0.015425785718434781,
    0.015212955035110554,
    0.014908189143682193,
    0.015072550239892735,
    0.01532563948421739,
    0.01523251673967252,
    0.015064783750688093,
    0.015224873716420007,
    0.015222345734002829,
    0.015259316419076185,
    0.015243212098084769,
    0.015403913907732658,
    0.015347585215636173,
    0.015412241789135805,
    0.015369958369262804,
    0.015331428617002985,
    0.015316195179195802,
    0.015227354266528437,
    0.015325451396904555,
    0.015110053478167629,
]

# FID After
random_fid_after = [
    22.299713134765625,
    23.580764770507812,
    22.6419677734375,
    22.38116455078125,
    22.736007690429688,
    22.025955200195312,
    23.103912353515625,
    22.227279663085938,
    24.1263427734375,
    23.72503662109375,
    24.000640869140625,
    24.415374755859375,
    23.866958618164062,
    24.056472778320312,
    24.447906494140625,
    24.132080078125,
    24.239532470703125,
    24.798370361328125,
    23.926773071289062,
    25.219268798828125,
    25.229446411132812,
    23.80877685546875,
    25.058074951171875,
    24.6622314453125,
    24.519180297851562,
    25.446456909179688,
    24.819259643554688,
    24.201766967773438,
    23.6773681640625,
    25.25921630859375,
    26.11956787109375,
    25.424575805664062,
    25.401321411132812,
    25.10992431640625,
    25.290023803710938,
    26.142120361328125,
    25.443817138671875,
    25.0701904296875,
    25.289642333984375,
    25.449050903320312,
    26.1016845703125,
    25.104080200195312,
    25.487274169921875,
    25.015960693359375,
    25.312713623046875,
    25.934402465820312,
    25.38262939453125,
    25.194183349609375,
    25.746902465820312,
    24.522567749023438,
    25.402297973632812,
    26.578155517578125,
    25.87646484375,
    25.810470581054688,
    25.862030029296875,
    25.95489501953125,
    25.900146484375,
    25.541015625,
    25.597381591796875,
    25.79156494140625,
    26.828994750976562,
    26.892410278320312,
    26.230026245117188,
    26.102462768554688,
    25.869216918945312,
    26.596038818359375,
    25.782318115234375,
    25.943435668945312,
    26.367401123046875,
    26.772506713867188,
    25.984848022460938,
    27.35284423828125,
    25.9188232421875,
    26.024566650390625,
    26.087417602539062,
    26.741119384765625,
    26.852951049804688,
    25.943588256835938,
    26.246124267578125,
    26.449996948242188,
    25.559524536132812,
    26.56671142578125,
    26.362350463867188,
    27.694122314453125,
    27.183486938476562,
    26.069015502929688,
    26.694427490234375,
    25.491729736328125,
    26.023818969726562,
    26.186676025390625,
    27.0435791015625,
    27.322586059570312,
    25.874252319335938,
    27.148330688476562,
    26.65167236328125,
    26.429122924804688,
    25.749923706054688,
    26.966049194335938,
    27.0235595703125,
]

# Loss 0 After
random_loss_0_after = [
    0.024970149791476375,
    0.0226791541263157,
    0.021539530821847824,
    0.02008334460088565,
    0.019616836067099047,
    0.01919506417245281,
    0.018492880389474484,
    0.017978647287117736,
    0.01763539317453622,
    0.017236994009712063,
    0.016991542508749635,
    0.016671479071433445,
    0.016470993855702026,
    0.016314046591881435,
    0.01587808228582524,
    0.01563637037191312,
    0.015502317426060992,
    0.015367768574220945,
    0.015192607289883402,
    0.015105720256379216,
    0.014972363114452028,
    0.014828427145922822,
    0.014682938670739531,
    0.014522021514724712,
    0.014438185938016265,
    0.01431089649499603,
    0.014221779720819725,
    0.01411100529248313,
    0.014017028102594219,
    0.014040639070908027,
    0.013900279361821179,
    0.013779889641576731,
    0.013692908108291425,
    0.01363942741573199,
    0.013573645596506492,
    0.013441758781757053,
    0.01334595941814917,
    0.01331607378420553,
    0.0132981587857084,
    0.013126500385661363,
    0.013106164922320036,
    0.013132560565326438,
    0.013025293268301354,
    0.012966617814987442,
    0.012942787780597502,
    0.012856749393407028,
    0.012857897523600533,
    0.012743628207755712,
    0.012743991664230672,
    0.012687590534618239,
    0.012673648710514665,
    0.012588449798248785,
    0.012537349496340873,
    0.012520059011401418,
    0.01240554697388707,
    0.012403448016088153,
    0.012402477017983946,
    0.012346691865597528,
    0.012342985469980963,
    0.012265338057566586,
    0.012203995365060259,
    0.012169150913096205,
    0.012159799921744483,
    0.012154389406335826,
    0.012088207472638435,
    0.01205210664822739,
    0.01202097714793089,
    0.011964748485241922,
    0.01194659314921354,
    0.011928962295095684,
    0.011948437873055513,
    0.011887972434859114,
    0.011835201046600633,
    0.011776051051411017,
    0.011788934932270904,
    0.011782737564276525,
    0.011750337917224638,
    0.011746697141836416,
    0.01173758265985252,
    0.011703553801516489,
    0.011656292525300642,
    0.011610735627128837,
    0.011642223813010341,
    0.011570842915015029,
    0.011597525895744257,
    0.011533696965637559,
    0.011537181523067838,
    0.011475443512638461,
    0.011467496587476712,
    0.01142428235307678,
    0.01143003960320612,
    0.011414697707858773,
    0.011426431859596348,
    0.011396592843099212,
    0.011382288744730153,
    0.011329505891463131,
    0.01132042126240665,
    0.011257807145664963,
    0.011297534631413161,
]

# FID 0 After
random_fid_0_after = [
    56.17433166503906,
    48.41624450683594,
    45.86168670654297,
    42.14452362060547,
    40.79627990722656,
    40.245330810546875,
    36.27222442626953,
    39.06610107421875,
    35.723411560058594,
    35.49217987060547,
    32.418701171875,
    33.68946838378906,
    30.755462646484375,
    32.998130798339844,
    31.135589599609375,
    29.206771850585938,
    30.249771118164062,
    31.07958984375,
    30.207061767578125,
    28.1751708984375,
    29.237205505371094,
    27.974288940429688,
    28.469940185546875,
    29.97698211669922,
    27.013961791992188,
    28.6025390625,
    28.615936279296875,
    27.453109741210938,
    26.839996337890625,
    28.026451110839844,
    27.745773315429688,
    27.540740966796875,
    27.22454833984375,
    27.83111572265625,
    27.464157104492188,
    26.833465576171875,
    26.480987548828125,
    27.058189392089844,
    25.93743896484375,
    27.468849182128906,
    25.45379638671875,
    26.994461059570312,
    27.016448974609375,
    26.979629516601562,
    26.300918579101562,
    27.097976684570312,
    26.49610137939453,
    25.8629150390625,
    26.680404663085938,
    26.116043090820312,
    27.01068115234375,
    26.110076904296875,
    26.818771362304688,
    26.186767578125,
    25.842941284179688,
    26.68231201171875,
    26.908401489257812,
    26.089736938476562,
    26.591163635253906,
    26.171371459960938,
    26.620162963867188,
    26.735015869140625,
    26.149368286132812,
    26.196945190429688,
    26.738571166992188,
    26.2239990234375,
    26.45830535888672,
    26.423011779785156,
    26.36731719970703,
    26.058212280273438,
    26.768043518066406,
    26.146713256835938,
    26.072120666503906,
    26.844940185546875,
    26.66973114013672,
    26.76848602294922,
    26.648635864257812,
    26.429916381835938,
    26.09699249267578,
    26.626449584960938,
    26.602706909179688,
    26.793350219726562,
    26.942962646484375,
    26.54181671142578,
    26.9302978515625,
    26.49219512939453,
    26.72864532470703,
    26.15735626220703,
    26.805770874023438,
    26.581863403320312,
    27.396888732910156,
    26.69780731201172,
    26.873931884765625,
    26.648529052734375,
    26.83282470703125,
    27.006202697753906,
    26.716346740722656,
    26.713470458984375,
    27.029090881347656,
]


targeted_loss_after = [
    0.015929528110291358,
    0.015270618898966859,
    0.01530845246975332,
    0.015178724352097106,
    0.015018932455291178,
    0.01503167906167846,
    0.015205097187276806,
    0.015140276198906122,
    0.015159798271724867,
    0.01499270305362188,
    0.015579733635661341,
    0.015010401603944956,
    0.015438613317940053,
    0.015508409729022787,
    0.014988203458244698,
    0.015383482597002285,
    0.01492722450132078,
    0.014907798471313072,
    0.015120954311441892,
    0.015378991020099875,
    0.014739560718908251,
    0.015177820086762495,
    0.015092382689033457,
    0.015149370014228225,
    0.015415999823403581,
    0.01537312981292871,
    0.015046888135771042,
    0.01562687754488934,
    0.015343728705772719,
    0.01503714975120829,
    0.015417188894900846,
    0.015611737933454606,
    0.015496310488572362,
    0.015275713919550071,
    0.0153805173003434,
    0.015142581012241862,
    0.015404880760229389,
    0.015108653775030234,
    0.01520674489972862,
    0.01491785130764356,
    0.0156643224737536,
    0.015509287271015637,
    0.01564078293432658,
    0.015061089518098925,
    0.01525285187199188,
    0.015090240204756356,
    0.01567679032018532,
    0.015726760194240796,
    0.015197404079515309,
    0.015093045657522453,
    0.015524417124936463,
    0.015293739006949636,
    0.01523376839594448,
    0.015089117922059359,
    0.015194104695694932,
    0.015267195820058532,
    0.015520530673654775,
    0.015277350683163604,
    0.015207601341558075,
    0.015225565475930125,
    0.015681020248564437,
    0.01538597431317612,
    0.01549040791059042,
    0.015297605812833126,
    0.015710531630929836,
    0.015382210477014269,
    0.015062361049729134,
    0.015279337876279442,
    0.014937251055243905,
    0.015182787490061855,
    0.015754496640283833,
    0.015208110980324818,
    0.015369672478186658,
    0.015659883290993548,
    0.015268538453369729,
    0.014843435208604205,
    0.015069525304681974,
    0.015356642459494196,
    0.015135930946826193,
    0.015454573173656172,
    0.015081047027308614,
    0.015409390454976801,
    0.015230683215463614,
    0.015481337316373356,
    0.015430210801469002,
    0.015164612684657186,
    0.015378738955746485,
    0.01516706103427623,
    0.015495777492162688,
    0.015385886383739944,
    0.015068546287693607,
    0.015751082715041775,
    0.015157216947500274,
    0.01543914646435951,
    0.01525244525959124,
    0.015301888776320993,
    0.015190957212382727,
    0.015206230373166818,
    0.015596944433980298,
]
targeted_fid_after = [
    23.781906127929688,
    21.603546142578125,
    22.249496459960938,
    22.608810424804688,
    22.963668823242188,
    22.233291625976562,
    23.767105102539062,
    23.339950561523438,
    23.163040161132812,
    24.075408935546875,
    24.219207763671875,
    23.675201416015625,
    23.804183959960938,
    24.5047607421875,
    25.154205322265625,
    23.6246337890625,
    23.931106567382812,
    23.834259033203125,
    23.603958129882812,
    24.320602416992188,
    23.82025146484375,
    24.03717041015625,
    23.9757080078125,
    24.0311279296875,
    24.172225952148438,
    23.542449951171875,
    24.282913208007812,
    24.532394409179688,
    23.654098510742188,
    25.1163330078125,
    25.185592651367188,
    25.337066650390625,
    24.724578857421875,
    23.675460815429688,
    24.988739013671875,
    24.18865966796875,
    25.840133666992188,
    24.8565673828125,
    24.652755737304688,
    24.500900268554688,
    25.6146240234375,
    25.427001953125,
    25.68328857421875,
    24.598953247070312,
    24.770294189453125,
    24.275482177734375,
    24.754043579101562,
    25.962692260742188,
    24.856292724609375,
    25.091629028320312,
    25.274215698242188,
    25.917221069335938,
    26.199539184570312,
    24.82928466796875,
    25.130203247070312,
    25.606048583984375,
    25.874954223632812,
    25.800048828125,
    25.18603515625,
    24.666259765625,
    24.978424072265625,
    25.493453979492188,
    25.800140380859375,
    25.618789672851562,
    26.363876342773438,
    25.608856201171875,
    25.379791259765625,
    25.34124755859375,
    25.691680908203125,
    25.513275146484375,
    25.984344482421875,
    25.647872924804688,
    26.036712646484375,
    26.641265869140625,
    25.877761840820312,
    25.902145385742188,
    25.696441650390625,
    26.17864990234375,
    25.634475708007812,
    25.307022094726562,
    24.548828125,
    25.612686157226562,
    26.70159912109375,
    26.595672607421875,
    25.618759155273438,
    26.071548461914062,
    26.129302978515625,
    26.304977416992188,
    25.54180908203125,
    25.86578369140625,
    26.306640625,
    27.33154296875,
    25.081741333007812,
    27.44732666015625,
    25.579605102539062,
    26.153549194335938,
    26.710372924804688,
    26.858016967773438,
    26.323089599609375,
]
targeted_loss0_after = [
    0.026337351942701,
    0.02400982122659227,
    0.022673774376625613,
    0.02093916485627771,
    0.019891256553938193,
    0.019343747309770207,
    0.01846829832018334,
    0.018092966642306776,
    0.017378928912898564,
    0.017402303828002542,
    0.016837640013545752,
    0.016673642091396056,
    0.016338268512555834,
    0.01618062648399524,
    0.015767530844147715,
    0.01592834200591267,
    0.015491052997317544,
    0.015243744445793635,
    0.015190408713355356,
    0.015002218296998465,
    0.014883457450671312,
    0.014713136256881514,
    0.0147551298671288,
    0.014467448630959404,
    0.014408379276188052,
    0.014346295378731602,
    0.01419981895252226,
    0.014131926727357644,
    0.014196739425616604,
    0.013839018768488372,
    0.01395649923824192,
    0.013663744596213254,
    0.01371276622010889,
    0.0136370137735384,
    0.013580795166519832,
    0.01357573525200845,
    0.013500031496027522,
    0.013345662076073718,
    0.013419812724792531,
    0.013250567501515377,
    0.013218739757323827,
    0.013174402748700232,
    0.013137938257791483,
    0.013045512940687108,
    0.013005962701542874,
    0.012995696913127845,
    0.0129172442839671,
    0.01285378040926417,
    0.012764052577715899,
    0.012744542068982383,
    0.012741719512981647,
    0.012648598261282076,
    0.012687946484205598,
    0.01259329348555481,
    0.01253093027186637,
    0.012527317839332534,
    0.012466362696521136,
    0.012387209758637663,
    0.012311727645312798,
    0.012352713573324894,
    0.012362673224368114,
    0.012246966785133569,
    0.012240515598713668,
    0.012185861174568382,
    0.012185215105169586,
    0.012108090434137884,
    0.012035768861141131,
    0.012063373113051057,
    0.0121061012365057,
    0.012017430864483574,
    0.011985467922664722,
    0.011927079231174169,
    0.011911323372208115,
    0.011906542975398502,
    0.01183169001513826,
    0.01185548158091664,
    0.011793020657710351,
    0.011786849404761225,
    0.011741165862637288,
    0.01169305047571507,
    0.011681496138846007,
    0.011668317105944211,
    0.011598109540396502,
    0.011633593278072242,
    0.011571312293990003,
    0.011547201951462015,
    0.011532847464027605,
    0.011524159350308913,
    0.011487723010050474,
    0.011468314968657738,
    0.011459079589124541,
    0.011416948701692175,
    0.011393306313120589,
    0.01139672694570974,
    0.011368614920814122,
    0.011353573922486026,
    0.011322425328651253,
    0.011274330834002822,
    0.011294993397551684,
]
targeted_fid0_after = [
    61.11083984375,
    52.890838623046875,
    49.376800537109375,
    43.20758819580078,
    41.221160888671875,
    35.73661804199219,
    36.71099853515625,
    34.286651611328125,
    32.8814697265625,
    32.14501953125,
    30.93834686279297,
    29.198623657226562,
    29.388565063476562,
    28.48358154296875,
    28.712997436523438,
    27.907135009765625,
    26.774429321289062,
    28.137557983398438,
    28.233688354492188,
    26.039169311523438,
    26.695846557617188,
    26.443756103515625,
    26.075271606445312,
    25.659500122070312,
    26.415145874023438,
    25.140625,
    26.869781494140625,
    24.8079833984375,
    26.585159301757812,
    24.658538818359375,
    26.160018920898438,
    24.330596923828125,
    25.37493896484375,
    24.532150268554688,
    24.73504638671875,
    24.703094482421875,
    25.585342407226562,
    24.863128662109375,
    25.3577880859375,
    24.473480224609375,
    25.5386962890625,
    24.294570922851562,
    25.1900634765625,
    25.380523681640625,
    24.316497802734375,
    25.337493896484375,
    24.996429443359375,
    24.471832275390625,
    24.81982421875,
    25.669723510742188,
    24.88616943359375,
    24.799087524414062,
    25.1717529296875,
    25.225616455078125,
    24.922607421875,
    25.198394775390625,
    24.935623168945312,
    24.588958740234375,
    24.821243286132812,
    25.831832885742188,
    25.732177734375,
    25.2835693359375,
    25.236297607421875,
    25.583953857421875,
    25.184707641601562,
    25.098770141601562,
    25.17535400390625,
    25.119171142578125,
    25.206314086914062,
    25.57623291015625,
    25.54950714111328,
    25.29010009765625,
    25.27435302734375,
    26.140594482421875,
    25.64208221435547,
    25.903038024902344,
    25.876853942871094,
    26.504852294921875,
    25.962417602539062,
    25.650054931640625,
    25.6104736328125,
    26.095199584960938,
    26.630332946777344,
    26.060440063476562,
    25.832229614257812,
    26.678634643554688,
    25.902992248535156,
    26.290542602539062,
    26.114547729492188,
    26.005767822265625,
    26.612342834472656,
    26.543258666992188,
    27.04857635498047,
    26.71595001220703,
    26.658905029296875,
    26.850250244140625,
    26.837310791015625,
    27.020034790039062,
    26.8619384765625,
]


def create_comparison_plots(
    proportions,
    random_loss_after,
    random_fid_after,
    random_loss_0_after,
    random_fid_0_after,
    targeted_loss_after,
    targeted_fid_after,
    targeted_loss0_after,
    targeted_fid0_after,
):
    """
    Create comparison plots for targeted vs random selection fine-tuning results
    """

    # Create results directory if it doesn't exist
    os.makedirs("results", exist_ok=True)

    # Plot 1: Loss Comparison
    plt.figure(figsize=(12, 8))

    # Loss subplot
    plt.subplot(2, 1, 1)
    plt.plot(
        proportions,
        targeted_loss_after,
        label="Loss (Test) - Targeted",
        linewidth=2,
    )
    plt.plot(
        proportions,
        targeted_loss0_after,
        label="Loss (Test only 0) - Targeted",
        linewidth=2,
    )
    plt.plot(
        proportions,
        random_loss_after,
        label="Loss (Test) - Random",
        linewidth=2,
    )
    plt.plot(
        proportions,
        random_loss_0_after,
        label="Loss (Test only 0) - Random",
        linewidth=2,
    )

    plt.xlabel("Proportion of Data")
    plt.ylabel("Loss")
    plt.title("Fine-tuning Loss: Targeted vs Random Selection")
    plt.legend()
    plt.grid(True, alpha=0.3)

    # FID subplot
    plt.subplot(2, 1, 2)
    plt.plot(
        proportions,
        targeted_fid_after,
        label="FID (Test) - Targeted",
        linewidth=2,
    )
    plt.plot(
        proportions,
        targeted_fid0_after,
        label="FID (Test only 0) - Targeted",
        linewidth=2,
    )
    plt.plot(
        proportions,
        random_fid_after,
        label="FID (Test) - Random",
        linewidth=2,
    )
    plt.plot(
        proportions,
        random_fid_0_after,
        label="FID (Test only 0) - Random",
        linewidth=2,
    )

    plt.xlabel("Proportion of Data")
    plt.ylabel("FID")
    plt.title("Fine-tuning FID: Targeted vs Random Selection")
    plt.legend()
    plt.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig(
        "results/comparison_metrics_vs_percentile.png", dpi=300, bbox_inches="tight"
    )
    print(
        "Combined comparison plot saved to: results/comparison_metrics_vs_percentile.png"
    )

    # Clean up matplotlib figures to free memory
    plt.close("all")

    # Print some summary statistics
    print("\n--- Summary Statistics ---")
    print(f"Data points: {len(proportions)}")
    print(f"Proportion range: {min(proportions):.2f} to {max(proportions):.2f}")

    if targeted_loss_after and random_loss_after:
        min_targeted_loss = min(targeted_loss_after)
        min_random_loss = min(random_loss_after)
        print(f"Best targeted loss: {min_targeted_loss:.6f}")
        print(f"Best random loss: {min_random_loss:.6f}")
        print(
            f"Improvement: {((min_random_loss - min_targeted_loss) / min_random_loss * 100):.2f}%"
        )

    if targeted_fid_after and random_fid_after:
        min_targeted_fid = min(targeted_fid_after)
        min_random_fid = min(random_fid_after)
        print(f"Best targeted FID: {min_targeted_fid:.3f}")
        print(f"Best random FID: {min_random_fid:.3f}")
        print(
            f"FID improvement: {((min_random_fid - min_targeted_fid) / min_random_fid * 100):.2f}%"
        )


if __name__ == "__main__":
    create_comparison_plots(
        proportions,
        random_loss_after,
        random_fid_after,
        random_loss_0_after,
        random_fid_0_after,
        targeted_loss_after,
        targeted_fid_after,
        targeted_loss0_after,
        targeted_fid0_after,
    )
